<!-- indexer::stop -->
<p class="back"><a href="javascript:history.go(-1)" title="Zurück">Zurück</a></p>

<div class="event event-detailview layout_full block{{ getEventData.invoke('class')|raw }}">

    {% if getEventData.invoke('eventState') %}
        <h4 class="event-state-headline mt-3 mb-0">{{ getEventData.invoke('eventStateLabel') }}</h4>
    {% endif %}

    <!-- indexer::continue -->
    <h1 class="ce_headline mt-3">{{ getEventData.invoke('title') }}</h1>
    <!-- indexer::stop -->

    {% if  getEventData.invoke('eventType') == 'lastMinuteTour' %}
        <h4 class="ce_headline last-minute-tour">Last minute tour (Spontantour)</h4>
    {% endif %}

    <div class="row gx-5">
        <!-- Start col left -->
        <div class="col-lg-6">
            <div class="mb-3 p-4 bg-white">
                {% if not getEventData.invoke('teaser') is empty %}
                    <!-- indexer::continue -->
                    <div class="teaser event-detail mb-3">
                        <p><strong>{{ getEventData.invoke('teaser') }}</strong></p>
                    </div>
                    <!-- indexer::stop -->
                {% endif %}

                <div class="eventdate event-detail event-info-box icon-box-small">
                    <h5>Datum/Dauer</h5>
                    <p>{{ getEventData.invoke('eventPeriodLg')|raw }}</p>
                </div>

                <div class="organizers event-detail event-info-box icon-box-small">
                    <h5>Organisierende Gruppe</h5>
                    <div class="event-detail event-info-box organizer-logo mb-4">
                        {{ getEventData.invoke('eventOrganizerLogos')|raw }}
                    </div>
                    {% if not getEventData.invoke('eventOrganizers') is empty %}
                        <p>{{ getEventData.invoke('eventOrganizers')|raw }}</p>
                    {% else %}
                        <p>Keine Gruppe ausgewählt</p>
                    {% endif %}
                </div>

                {% if getEventData.invoke('mountainguide') %}
                    <div class="eventdate event-detail event-info-box icon-box-small">
                        <h5>Mit Bergführer/in</h5>
                    </div>
                {% endif %}

                <div class="requirements event-detail event-info-box icon-box-small">
                    <h5>Eventnummer</h5>
                    <!-- indexer::continue -->
                    <p class="event-id">
                        {#  event id f.ex. 2019-3233331 #}
                        {{ getEventData.invoke('eventId') }}
                    </p>
                    <!-- indexer::stop -->
                </div>

                {% if not getEventData.invoke('location') is empty %}
                    <div class="location event-detail event-info-box icon-box-small">
                        <h5>Veranstaltungsort</h5>
                        <!-- indexer::continue -->
                        <p>{{ getEventData.invoke('location') }}</p>
                        <!-- indexer::stop -->
                    </div>
                {% endif %}

                {% if getEventData.invoke('hasCoords') %}
                    <div class="geo-location event-detail event-info-box icon-box-small">
                        <h5>Karte</h5>
                        <!-- indexer::continue -->
                        <div class="event-info-box-inner swiss-topo-location-map">
                            <iframe src="{{ getEventData.invoke('geoLinkUrl') }}" width="100%" height="100%" allow="geolocation"></iframe>
                        </div>
                        <!-- indexer::stop -->
                    </div>
                {% endif %}

                {% if not getEventData.invoke('leistungen') is empty %}
                    <div class="price event-detail event-info-box icon-box-small">
                        <h5>Leistungen/Preis</h5>
                        <p>{{ getEventData.invoke('leistungen')|nl2br }}</p>
                    </div>
                {% endif %}

            </div>

            <div class="mt-3 mb-3 p-4 bg-white">
                <div class="instructor event-detail event-info-box icon-box-small">
                    <h5>Leitung/Betreuung</h5>
                    {% if not getEventData.invoke('instructorContactBoxes') is empty %}
                        <!-- indexer::continue -->
                        <div class="row mt-3 gx-2 gy-1">
                            {{ getEventData.invoke('instructorContactBoxes')|raw }}
                        </div>
                        <!-- indexer::stop -->
                    {% else %}
                        <p>Leiter/in wurde gelöscht.</p>
                    {% endif %}
                </div>

                {% if getEventData.invoke('setRegistrationPeriod') %}
                    <div class="booking-text event-detail event-info-box icon-box-small">
                        <h5>Anmeldung möglich</h5>
                        <p>Vom {{ getEventData.invoke('registrationStartDateFormatted') }} bis zum {{ getEventData.invoke('registrationEndDateFormatted') }}</p>
                    </div>
                {% endif %}

                {% if not getEventData.invoke('bookingCounterAsText') is empty %}
                    <div class="booking-counter event-detail event-info-box icon-box-small">
                        <h5>Bestätigte Anmeldungen</h5>
                        <p>{{ getEventData.invoke('bookingCounterAsText') }}</p>
                    </div>
                {% endif %}

            </div>

            <div class="mt-3 mb-3 p-4 bg-white">

                {% if not getEventData.invoke('bookingEvent') is empty or getEventData.invoke('generateMainInstructorContactDataFromDb') %}
                    <div class="booking-text event-detail event-info-box icon-box-small">
                        <h5>Anmeldung</h5>
                        <p>{% if getEventData.invoke('disableOnlineRegistration') %}Keine {% endif %}Online-Anmeldung</p>

                        {% if not getEventData.invoke('bookingEvent') is empty %}
                            <p class="mt-3">{{ getEventData.invoke('bookingEvent') }}</p>
                        {% endif %}

                        {% if getEventData.invoke('generateMainInstructorContactDataFromDb') %}
                            <p class="mt-3">{{ getEventData.invoke('mainInstructorContactDataFromDb')|raw }}</p>
                        {% endif %}
                    </div>
                {% endif %}

                <!-- buttons -->
                <div class="d-flex flex-wrap">
                    <div class="mt-3 me-3">
                        <a href="_download/download_event_ical?eventId={{ getEventData.invoke('id') }}" title="Event in Kalender importieren" class="btn btn-block btn-outline-primary">
                            <i class="fal fa-calendar-plus"></i> iCal download
                        </a>
                    </div>

                    {% if not getEventData.invoke('disableOnlineRegistration') %}
                        <div class="event-detail-buttons mt-3">
                            <!-- "book event" button -->
                            <!-- indexer::continue -->
                            {{ "{{insert_module::408}}" }}
                            <!-- indexer::stop -->
                        </div>
                    {% endif %}
                </div>
                <!-- end buttons -->

            </div>
        </div>
        <!-- End col left -->

        <!-- Start col right -->
        <div class="col-lg-6">
            <div class="p-4">

                {% if not getEventData.invoke('tourType') is empty %}
                    <div class="tour-type event-detail event-info-box icon-box-small">
                        <!-- indexer::continue -->
                        <h5 class="mt-lg-0">Touren-Typ</h5>
                        <p>{{ getEventData.invoke('tourTypesTitles')|raw }}</p>
                        <!-- indexer::stop -->
                    </div>
                {% endif %}

                {% if getEventData.invoke('eventType') == 'tour' %}
                    <div class="tour-difficulties event-detail event-info-box icon-box-small">
                        <h5>Schwierigkeit</h5>
                        <p>{{ getEventData.invoke('tourTechDifficultiesAsArray')|join('<br>')|raw }}</p>
                    </div>
                {% endif %}

                {% if getEventData.invoke('eventType') == 'tour' or getEventData.invoke('eventType') == 'lastMinuteTour' %}
                    {% if getEventData.invoke('suitableForBeginners') %}
                        <div class="suitableForBeginners event-detail event-info-box icon-box-small">
                            <!-- indexer::continue -->
                            <h5>Für Anfänger geeignet</h5>
                            <p>Ideale Tour für Einsteiger</p>
                            <!-- indexer::stop -->
                        </div>
                    {% endif %}
                {% endif %}

                {% if not getEventData.invoke('requirements') is empty %}
                    <div class="requirements event-detail event-info-box icon-box-small">
                        <h5>Voraussetzungen/Anforderungen</h5>
                        <!-- indexer::continue -->
                        <p class="requirements-text">{{ getEventData.invoke('requirements')|nl2br }}</p>
                        <!-- indexer::stop -->
                    </div>
                {% endif %}

                {% if getEventData.invoke('eventType') == 'tour' and not getEventData.invoke('tourDetailText') is empty %}
                    <div class="tour-detail-text event-detail event-info-box icon-box-small">
                        <h5>Route/Details</h5>
                        <!-- indexer::continue -->
                        <p>{{ getEventData.invoke('tourDetailText')|nl2br }}</p>
                        <!-- indexer::stop -->
                    </div>
                {% endif %}

                {% if getEventData.invoke('eventType') == 'generalEvent' and not getEventData.invoke('generalEventDetailText') is empty %}
                    <div class="general-event-detail-text event-detail event-info-box icon-box-small">
                        <h5>Details</h5>
                        <!-- indexer::continue -->
                        <p>{{ getEventData.invoke('generalEventDetailText')|nl2br }}</p>
                        <!-- indexer::stop -->
                    </div>
                {% endif %}

                {% if getEventData.invoke('eventType') == 'tour' and not getEventData.invoke('arrTourProfile') is empty %}
                    <div class="tour-profile event-detail event-info-box icon-box-small">
                        <h5>Profil</h5>
                        <p>{{ getEventData.invoke('arrTourProfile')|join('<br>')|raw }}<p>
                    </div>
                {% endif %}

                {% if not getEventData.invoke('journey') is empty and getEventData.invoke('journey') != 'not-specified' %}
                    <div class="journey event-detail event-info-box icon-box-small">
                        <h5>Anreise mit</h5>
                        <p>{{ getEventData.invoke('journey')|nl2br }}</p>
                    </div>
                {% endif %}

                {% if not getEventData.invoke('meetingPoint') is empty %}
                    <div class="meeting-point event-detail event-info-box icon-box-small">
                        <h5>Zeit und Treffpunkt</h5>
                        <p>{{ getEventData.invoke('meetingPoint')|nl2br }}</p>
                    </div>
                {% endif %}

                {% if not getEventData.invoke('equipment') is empty %}
                    <div class="equipment event-detail event-info-box icon-box-small">
                        <h5>Benötigtes Material</h5>
                        <p>{{ getEventData.invoke('equipment')|nl2br }}</p>
                    </div>
                {% endif %}

                {% if not getEventData.invoke('miscellaneous') is empty %}
                    <div class="miscellaneous event-detail event-info-box icon-box-small last">
                        <h5>Sonstiges</h5>
                        <p>{{ getEventData.invoke('miscellaneous')|nl2br }}</p>
                    </div>
                {% endif %}

                {% if not getEventData.invoke('linkSacRoutePortal') is empty %}
                    <div class="links event-detail event-info-box icon-box-small">
                        <h5>Links</h5>
                        <div class="ce_hyperlink">
                            <a class="hyperlink_txt" href="{{ getEventData.invoke('linkSacRoutePortal') }}" target="_blank" title="SAC-Tourenportal">Routen-Details auf SAC-Tourenportal</a>
                        </div>
                    </div>
                {% endif %}

            </div>
        </div>
        <!-- End col right -->
    </div>

    <!-- enclosures/downloads -->
    {# !Urheberrechtsverletzung bei urheberrechtlich geschützten Anhängen wie Topos, Karten, etc. #}
    {% if hasLoggedInFrontendUser or 'eventPreview' == app.request.query.get('modee') %}
        {% if getEventData.invoke('enclosure') %}
            <div class="event-eclosures event-detail event-info-box icon-box-small">
                <h5>Downloads/weitere Informationen</h5>
                <div class="enclosure">
                    {% for enclosureItem in enclosure %}
                        <p>
                            <img src="{{ enclosureItem.icon }}" width="18" height="18" alt="{{ enclosureItem.mime }}" class="mime_icon">
                            <a href="{{ enclosureItem.href }}" title="{{ enclosureItem.title }}">{{ enclosureItem.link }} <span class="size">({{ enclosureItem.filesize }})</span></a>
                        </p>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    {% endif %}

    {# Gallery #}
    {% if getEventData.invoke('addGallery') %}
        <!-- gallery start -->
        <hr class="mt-5 mb-5">
        {{ getEventData.invoke('gallery')|raw }}
        <!-- gallery end -->
    {% endif %}

</div>
<!-- indexer::continue -->

{# Use a callable inside src/EventListener/Contao/EventParseTemplateListener.php to get "schema.org" data #}
{% do addSchemaOrg.invoke() %}

{#
{% set schemaOrg = getSchemaOrgData.invoke() %}
{% if hasDetails %}
    {% set schemaOrg = schemaOrg|merge({
        "description": rawHtmlToPlainText.invoke(details)
    }) %}
{% endif %}
{% do addSchemaOrg.invoke(schemaOrg) %}
#}
